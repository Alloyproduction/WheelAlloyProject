<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <template id="report_style_inherit" inherit_id="web.report_assets_common">
            <xpath expr="." position="inside">
                <link href="/einv_sa/static/css/report_style.css" rel="stylesheet" type="text/css"/>
            </xpath>
        </template>


        <!--         report action  -->
        <record id="action_tax_invoice_report" model="ir.actions.report">
            <field name="name">  Invoice - الفاتورة </field>
            <field name="model">account.invoice</field>
            <field name="report_type">qweb-pdf</field>
            <field name="report_name">einv_sa.account_move_report</field>
            <field name="report_file">einv_sa.account_move_report</field>
            <field name="print_report_name">(object._get_report_base_filename())</field>
            <field name="binding_model_id" ref="model_account_invoice"/>
            <field name="binding_type">report</field>
        </record>

<!--                <report id="einv_tax_invoice"  model="account.move" string="Tax Invoic - فاتورة ضريبية"-->
<!--                    name="einv_sa.account_move_report"-->
<!--                    report_type="qweb-html"-->
<!--                    print_report_name="'Invoice - %s' % (object.name).replace('/', '')"-->
<!--                />-->

        <template id="einv_sa.inv_header">
            <div class="row p-1 my-2 border-bottom bg-light">
                <div class="col-12 text-center" style="font-size:1.2rem;">
                    <Strong>Tax Invoice فاتورة ضريبية</Strong>
                    <span t-if="doc.type=='out_refund'"> - Credit Note إشعار دائن</span>
                    <span t-if="doc.type=='in_refund'"> - Debit Note إشعار مدين</span>
                </div>
            </div>
            <div class="row my-1">
                <div class="col-9">
                    <div class="row">
                        <div class="col-4"><Strong>Invoice Number</Strong></div>
                        <div class="col-4 text-center"><span t-field="doc.number"></span></div>
                        <div class="col-4 text-right"><Strong>رقم الفاتورة</Strong></div>
                    </div>
                    <div class="row">
                        <div class="col-4"><Strong>Invoice Date</Strong></div>
                        <div class="col-4 text-center"><span t-field="doc.date_invoice"></span></div>
                        <div class="col-4 text-right"><Strong>تاريخ الفاتورة</Strong></div>
                    </div>
                    <div class="row">
                        <div class="col-4"><Strong>Due Date</Strong></div>
                        <div class="col-4 text-center"><span t-field="doc.date_due"></span></div>
                        <div class="col-4 text-right"><Strong>تاريخ الاستحقاق</Strong></div>
                    </div>
                     <div class="row">
                        <div class="col-4"><Strong> Source </Strong></div>
                        <div class="col-4 text-center"><span t-field="doc.origin"></span></div>
                        <div class="col-4 text-right"><Strong>المصدر</Strong></div>
                     </div>
                </div>
                <div class="col-3">

                    <img t-att-src="'/report/barcode/?type=%s&amp;width=%s&amp;height=%s&amp;value=Seller : %s;Vat_Number : %s;date : %s;Total_Vat : %s;Total_Amount : %s'%('QR', 130, 130,doc.company_id.name,doc.company_id.vat,doc.date_invoice,doc.amount_tax_signed,doc.amount_total)"
                         class="float-right my-1"/>

                </div>
            </div>
            <div class="oe_structure"/>
        </template>

        <template id="einv_sa.partner_info">
            <div class="row p-1 mt-1  bg-light">
                <div class="col-6"><Strong>Customer</Strong></div>
                <div class="col-6 text-right"><Strong>العميل</Strong></div>
            </div>
            <div class="px-2"/>
                <div class="row">
                    <div class="col-3"><Strong>Customer Name:</Strong></div>
                    <div class="col-5 text-center"><span t-field="doc.partner_id.name"></span></div>
                    <div class="col-4 text-right"><Strong>اسم العميل:</Strong></div>
                </div>

                <div class="row">
                    <div class="col-3"><Strong>Address:</Strong></div>
                    <div class="col-5 text-center"><span t-field="doc.partner_id.street"></span></div>
                    <div class="col-4 text-right"><Strong>العنوان:</Strong></div>
                </div>

                <div class="row">
                    <div class="col-3"><Strong>Mobile:</Strong></div>
                    <div class="col-5 text-center"><span t-field="doc.partner_id.mobile"></span></div>
                    <div class="col-4 text-right"><Strong>رقم الجوال:</Strong></div>
                </div>

                <div class="row">
                    <div class="col-3"><Strong>Email:</Strong></div>
                    <div class="col-5 text-center"><span t-field="doc.partner_id.email"></span></div>
                    <div class="col-4 text-right"><Strong>البريد الإلكتروني:</Strong></div>
                </div>
                <div class="row">
                    <div class="col-3"><Strong>City</Strong></div>
                    <div class="col-5 text-center"><span t-field="doc.partner_id.city"></span></div>
                    <div class="col-4 text-right"><Strong>المدينة:</Strong></div>
                </div>

                <div class="row">
                    <div class="col-3"><Strong>Vat Number</Strong></div>
                    <div class="col-5 text-center"><span t-field="doc.partner_id.vat"></span></div>
                    <div class="col-4 text-right"><Strong>رقم الضريبي : </Strong></div>

                </div>

                <div class="row">

                <div class="oe_structure"/>
            </div>
            <div class="oe_structure"/>

            <div class="row p-1 mt-1  bg-light">
                <div class="col-6"><Strong>Vehicle</Strong></div>
                <div class="col-6 text-right"><Strong>المركبة</Strong></div>
            </div>

               <div class="row">
                    <div class="col-3"><Strong>Agency Name:</Strong></div>
                    <div class="col-5 text-center"><span t-field="doc.sale_id.x_studio_field_icWOZ.name"></span></div>
                    <div class="col-4 text-right"><Strong>اسم الوكالة:</Strong></div>
                </div>


                <div class="row">
                     <div class="col-3"><Strong>Claim# :</Strong></div>
                     <div class="col-5 text-center"><span t-field="doc.sale_id.claim_no"></span></div>
                     <div class="col-4 text-right"><Strong>: رقم‬ ‫المطالبة:</Strong></div>
                </div>

                <div class="row">
                    <div class="col-3"><Strong>Service Advisor:</Strong></div>
                    <div class="col-5 text-center"><span t-field="doc.sale_id.service_advisor.name"></span></div>
                    <div class="col-4 text-right"><Strong>اسم المشرف:</Strong></div>
                </div>

                <div class="row">
                    <div class="col-3"><Strong>Job Card # :</Strong></div>
                    <div class="col-5 text-center"><span t-field="doc.sale_id.x_studio_agency_job_card"></span></div>
                    <div class="col-4 text-right"><Strong> رقم كرت عمل الوكالة:</Strong></div>
                </div>

                <div class="row">
                    <div class="col-3"><Strong>Plate # :</Strong></div>
                    <div class="col-5 text-center"><span t-field="doc.sale_id.vehicle.license_plate"></span></div>
                    <div class="col-4 text-right"><Strong>رقم اللوحة:</Strong></div>
                 </div>

                <div class="row">
                    <div class="col-3"><Strong>Car Type:</Strong></div>
                    <div class="col-5 text-center">
                        <span t-field="doc.sale_id.vehicle.model_id.name"></span>
                        <span t-field="doc.sale_id.vehicle.car_name1.name"></span>
               </div>
                   <div class="col-4 text-right"><Strong>اسم المركب:</Strong></div></div>


                <div class="row">
                    <div class="col-3"><Strong>Chasis # :</Strong></div>
                    <div class="col-5 text-center"><span t-field="doc.sale_id.vehicle.vin_sn"></span></div>
                    <div class="col-4 text-right"><Strong> ‫‫رقم الشاصية:</Strong></div>
                </div>

        </template>

        <template id="einv_sa.inv_lines">
            <div class="row p-1 mt-3 bg-light">
                <div class="col-6"><Strong>Invoice Lines</Strong></div>
                <div class="col-6 text-right"><Strong>الاصناف</Strong></div>
            </div>
            <table class="table table-sm o_main_table " name="invoice_line_ids_table">
                <thead class="bg-light text-center">
                    <tr>
                        <td class="text-left"><div class="mw-100">Name</div><div class="mw-100 ">الوصف</div></td>
                        <td><div class="mw-100">Quantity</div><div class="mw-100 "> الكمية</div></td>
                        <td><div class="mw-100">Price Unit</div><div class="mw-100 "> السعر</div></td>
                        <td><div class="mw-100">Discount</div><div class="mw-100 "> الخصم</div></td>
                        <td><div class="mw-100">Taxes</div><div class="mw-100 ">الضريبة</div></td>
                        <td><div class="mw-100">Amount tax</div><div class="mw-100 ">مبلغ بدون الضريبة</div></td>
                        <td><div class="mw-100">Taxable Amount</div><div class="mw-100 "> المبلغ شامل الضريبة</div></td>
                        <td><div class="mw-100">Price Total (with Vat)</div><div class="mw-100 ">المجموع</div></td>

                    </tr>
                </thead>
                <tbody class="invoice_line_ids_tbody text-center">
                    <!-- foreach-->
                    <tr t-foreach="doc.invoice_line_ids" t-as="line">
                        <td class="text-left"><span t-field="line.name"/></td>
                        <td><span t-field="line.quantity"/></td>
                        <td><span t-field="line.price_unit"/></td>
                        <td><span t-field="line.einv_amount_discount"/></td>
                        <!--                            <td><span t-field="line.tax_ids[0].name"/></td>-->
                        <td t-attf-class="{{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">
                            <span t-esc="', '.join(map(lambda x: (x.description or x.name), line.invoice_line_tax_ids))"
                                  id="line_tax_ids"/>
                        </td>
                        <td><span t-field="line.einv_amount_tax"/></td>
                        <td><span t-field="line.price_subtotal"/></td>
                        <td><span t-field="line.price_total"/></td>

                    </tr>
                </tbody>
            </table>
            <div class="oe_structure"/>
        </template>


        <template id="einv_sa.inv_total">
            <div style="page-break-inside: avoid;">
                <div class="row p-1 mt-1 bg-light">
                    <div class="col-6"><Strong>Total Amount: </Strong></div>
                    <div class="col-6 text-right"><Strong>:الاجمالي</Strong></div>
                </div>
                <div class="row">
                    <div class="col-2"></div>
                    <div class="col-10">
                        <div class="row border border-top-0">
                            <div class="col-4">Subtotal</div>
                            <div class="col-6 text-right">الاجمالي قبل الضريبة</div>
                            <div class="col-2 text-center"><span t-field="doc.einv_amount_sale_total"></span></div>
                        </div>
                        <div class="row border border-top-0">
                            <div class="col-4">Discount</div>
                            <div class="col-6 text-right">الخصم</div>
                            <div class="col-2 text-center"><span
                                    t-field="doc.einv_amount_discount_total"></span></div>
                        </div>
<!--                        <div class="row border border-top-0">-->
<!--                            <div class="col-4">Total Taxable Amount (Excluding VAT)</div>-->
<!--                            <div class="col-6 text-right">الإجمالي الخاضع للضريبة غير شامل ضريبة القيمة-->
<!--                                المضافة</div>-->
<!--                            <div class="col-2 text-center"><span t-field="doc.amount_untaxed"></span></div>-->
<!--                        </div>-->
<!--                        <div class="row border border-top-0">-->
<!--                            <div class="col-4">Total VAT</div>-->
<!--                            <div class="col-6 text-right">إجمالي الضريبة المضافة</div>-->
<!--                            <div class="col-2 text-center"><span t-field="doc.amount_tax_signed"></span></div>-->
<!--                        </div>-->
                        <div class="row border border-top-0">
                            <div class="col-4">Total </div>
                            <div class="col-6 text-right"> الإجمالي بعد الضريبة </div>
                            <div class="col-2 text-center"><span t-field="doc.amount_total"></span></div>
                        </div>
                    </div>

                </div>
            </div>
            <div class="oe_structure"/>

        </template>

        <!-- main document template -->
        <template id="einv_sa.account_move_report_document">
            <t t-debug=""></t>
            <t t-call="web.external_layout">
                <t t-set="doc" t-value="doc.with_context({'lang': lang})"/>
                <div class="page">

                    <!-- Invoice fields-->
                    <t t-call="einv_sa.inv_header"/>

                    <!-- partner fields-->
                    <t t-call="einv_sa.partner_info"/>

                    <!-- Invoice fields-->
                    <t t-call="einv_sa.inv_lines" t-lang="ar"/>

                    <!-- Invoice total-->
                    <t t-call="einv_sa.inv_total"/>
                </div>

                <div>
                    <!--                       <img src='static\img\Stamp.jpeg'-->
                    <!--                            style="max-height: 150px; margin-left:50px; margin-right:20px; margin-top:50px;"-->
                    <!--                       />-->
                    <img src='/invoice_report_customization/static/img/Stamp.jpeg'
                         style="max-height: 150px; margin-left:50px; margin-right:20px; margin-top:50px;"
                    />

                </div>

                <div class="offset-8">
                    <strong>Customer Sign</strong>
                    <br/>
                    <strong>‬‫توقيع ‫العميل‬‬</strong>
                    <span style="margin-left:30px;display: inline-block;
                          border-bottom: 1px solid #000;
                          width: 100px;  margin-left: 120px;margin-bottom:10px;
                          border-top: 1px solid #000;
                          width: 200px;
                          text-align: right;"></span>
                </div>

                <div>

                    <span>This invoice automatically generated in our system and should be considered as an original/
                        يتم انشاء هذ الفاتورة تلقائيا في نظامنا و يجب اعتبارها فاتورة أصلية‬
                    </span>
                </div>

            </t>
        </template>

        <!-- main template -->
        <template id="einv_sa.account_move_report">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="doc">
                    <t t-set="lang" t-value="doc.create_uid.lang"/>
                    <t t-call="einv_sa.account_move_report_document"/>
                </t>


            </t>
        </template>


    </data>
</odoo>